{% extends 'base.html' %}

{% block content %}
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <h1 class="text-center mb-4">Agregar datos</h1>

        {% if message %}
          <div class="alert alert-danger" role="alert">
            {{ message }}
          </div>
        {% endif %}

        <form action="{% url 'create_task' %}" method="POST">
          {% csrf_token %}
          <div class="form-group">
            <input type="text" name="title" class="form-control" placeholder="No. medidor">
          </div>
          <div class="form-group">
            <input type="text" name="description" id="coordinates-input" class="form-control" placeholder="Ejemplo: 13.343213, -12.133321">
            <button type="button" class="btn btn-primary btn-block mt-2" onclick="getCurrentPosition()">Ubicaci√≥n Actual</button>
          </div>
          <button type="submit" class="btn btn-primary btn-block mt-4">Guardar</button>
        </form>
      </div>
    </div>
  </div>

  <script>
    function getCurrentPosition() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          function(position) {
            var lat = position.coords.latitude;
            var lon = position.coords.longitude;
            document.getElementById("coordinates-input").value = lat + ", " + lon;
          },
          function(error) {
            console.log(error.message);
          }
        );
      } else {
        console.log("Geolocation is not supported by this browser.");
      }
    }
  </script>
{% endblock %}