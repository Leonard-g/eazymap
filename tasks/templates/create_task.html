{% extends 'base.html' %}

{% block content %}
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <h1 class="text-center mb-4">Agregar datos</h1>

        {% if message %}
          <div class="alert alert-danger" role="alert">
            {{ message }}
          </div>
        {% endif %}

        <form action="{% url 'create_task' %}" method="POST">
          {% csrf_token %}
          <div class="form-group">
            <input type="text" name="title" class="form-control" placeholder="No. medidor" pattern="[0-9]*" required>
          </div>
          <div class="form-group">
            <input type="text" name="description" id="coordinates-input" class="form-control" placeholder="Ejemplo: 18.4713216, -69.9203584" pattern="^-?\d+(\.\d+)?, -?\d+(\.\d+)?$">
            <div class="form-group text-center">
              <button type="button" class="btn btn-primary btn-block mt-2" style="width: 200px; height: 50px; font-size: 16px;" onclick="getCurrentPosition()">Ubicaci√≥n Actual</button>
              <button type="submit" class="btn btn-primary rounded-pill" style="width: 200px; height: 50px; font-size: 16px;">Guardar</button>            
        </form>
      </div>
    </div>
  </div>

  <style>
    .btn-primary {
      background-color: #27ae60;
      border-color: #27ae60;
    }

    .btn-primary:hover {
      background-color: #219a52;
      border-color: #219a52;
    }

    .form-control {
      border-radius: 30px;
      border-color: #dcdde1;
    }
  </style>

  <script>
    function getCurrentPosition() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          function(position) {
            var lat = position.coords.latitude;
            var lon = position.coords.longitude;
            document.getElementById("coordinates-input").value = lat + ", " + lon;
          },
          function(error) {
            console.log(error.message);
          }
        );
      } else {
        console.log("Geolocation is not supported by this browser.");
      }
    }
  </script>
{% endblock %}